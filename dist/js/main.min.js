ScrollTrigger.config({limitCallbacks:!0,ignoreMobileResize:!0,autoRefreshEvents:"visibilitychange,DOMContentLoaded,load"});const lenis=new Lenis({autoRaf:!0,lerp:.1,smooth:!0,smoothTouch: true,touchMultiplier: 2,easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),});let isMobile=window.innerWidth<=750,ticking=!1,lastScrollTop=0,isScrollingDown=!1;const scrollThreshold=5,activationThreshold=50;if(isMobile||lenis.on("scroll",(({scroll:e})=>{requestAnimationFrame((()=>{currentScroll=e;const t=document.querySelector(".header");t&&(Math.abs(currentScroll-lastScrollTop)>5&&(isScrollingDown=currentScroll>lastScrollTop,lastScrollTop=currentScroll),isScrollingDown&&currentScroll>50&&window.innerWidth>750?t.classList.add("back"):t.classList.remove("back"))}))})),document.querySelector(".gallery")){new Splide(".gallery-splide",{perPage:1,perMove:1,autoplay:!isMobile,interval:5e3,type:"fade",rewind:!0,drag:!0,swipe:!0}).mount(),setTimeout((()=>{document.querySelector(".gallery-splide").clientWidth;let e=document.querySelectorAll(".splide__pagination__page"),t=document.querySelector(".splide__pagination");if(t&&e.length>0){const i=parseFloat(getComputedStyle(t).gap)||0;let n=(t.clientWidth-(e.length+1)*i)/e.length;$(".splide__pagination__page").css({width:`${n}`})}}),100)}$(".menu-scrolling").on("click",(function(e){$(this).children(".burger").toggleClass("open"),$(".header").toggleClass("open")})),$(".header-menu-mob li").on("click",(function(e){$(".menu-scrolling").children(".burger").removeClass("open"),$(".header").removeClass("open")}));class AgencyTrail{constructor(e){this.agency=e,this.animationContainer=this.agency.querySelector(".wrap-agency-animation"),this.animationContainer?(this.isValid=!0,this.content=this.animationContainer.querySelector(".content"),this.content||(this.content=this.agency.querySelector(".content")),this.images=Array.from(this.content.querySelectorAll(".content__img")),this.imgInners=Array.from(this.content.querySelectorAll(".content__img-inner")),this.mouse={x:0,y:0},this.lastMouse={x:0,y:0},this.cacheMouse={x:0,y:0},this.zIndex=1,this.activeIndex=0,this.activeImagesCount=0,this.isIdle=!0,this.isPaused=!1,this.activationDistance=80,this.animationRect=this.animationContainer.getBoundingClientRect(),this.activeAnimations=new Map,this.hideAnimation=null,this.init()):this.isValid=!1}init(){this.isValid&&(this.hideAllImages(),this.setupEventListeners(),this.startTracking())}setupEventListeners(){this.isValid&&(this.animationContainer.addEventListener("mousemove",(e=>{this.updateAnimationRect(),this.mouse.x=e.clientX-this.animationRect.left,this.mouse.y=e.clientY-this.animationRect.top})),this.animationContainer.addEventListener("mouseenter",(e=>{this.isPaused=!1,this.updateAnimationRect(),this.mouse.x=e.clientX-this.animationRect.left,this.mouse.y=e.clientY-this.animationRect.top,this.cacheMouse.x=this.mouse.x,this.cacheMouse.y=this.mouse.y,this.lastMouse.x=this.mouse.x,this.lastMouse.y=this.mouse.y,this.hideAnimation&&(this.hideAnimation.kill(),this.hideAnimation=null)})),this.animationContainer.addEventListener("mouseleave",(e=>{this.isCursorInAnimationContainer(e)||(this.isPaused=!0,this.hideAllImagesSmoothly())})),document.addEventListener("mousemove",(e=>{this.isPaused&&this.isCursorInAnimationContainer(e)&&(this.isPaused=!1,this.hideAnimation&&(this.hideAnimation.kill(),this.hideAnimation=null),this.updateAnimationRect(),this.mouse.x=e.clientX-this.animationRect.left,this.mouse.y=e.clientY-this.animationRect.top,this.cacheMouse.x=this.mouse.x,this.cacheMouse.y=this.mouse.y,this.lastMouse.x=this.mouse.x,this.lastMouse.y=this.mouse.y)})))}isCursorInAnimationContainer(e){const t=this.animationContainer.getBoundingClientRect();return e.clientX>=t.left-2&&e.clientX<=t.right+2&&e.clientY>=t.top-2&&e.clientY<=t.bottom+2}updateAnimationRect(){this.animationRect=this.animationContainer.getBoundingClientRect()}startTracking(){if(!this.isValid)return;const e=()=>{this.isPaused||"visible"!==document.visibilityState||(this.cacheMouse.x=this.lerp(this.cacheMouse.x,this.mouse.x,.1),this.cacheMouse.y=this.lerp(this.cacheMouse.y,this.mouse.y,.1),this.checkDistanceAndSpawn()),this.raf=requestAnimationFrame(e)};this.raf=requestAnimationFrame(e),document.addEventListener("visibilitychange",(()=>{this.isPaused="visible"!==document.visibilityState}))}lerp(e,t,i){return e+(t-e)*i}getDistance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}checkDistanceAndSpawn(){this.getDistance(this.lastMouse,this.mouse)>this.activationDistance&&(this.spawnImage(),this.lastMouse={...this.mouse}),this.isIdle&&1!==this.zIndex&&(this.zIndex=1)}spawnImage(){if(this.isPaused||!this.isValid)return;this.activeImagesCount++,this.isIdle=!1,this.zIndex++,this.activeIndex=this.activeIndex<this.images.length-1?this.activeIndex+1:0;const e=this.images[this.activeIndex],t=this.imgInners[this.activeIndex];this.activeAnimations.has(e)&&this.activeAnimations.get(e).kill();const i=e.getBoundingClientRect();gsap.set(e,{x:this.mouse.x-i.width/2,y:this.mouse.y-i.height/2,scale:0,opacity:1,zIndex:this.zIndex}),gsap.set(t,{scale:2.8,filter:"brightness(150%)"});const n=gsap.timeline({onStart:()=>this.onImageActivate(),onComplete:()=>{this.onImageComplete(),this.activeAnimations.delete(e)}});this.activeAnimations.set(e,n),n.to(e,{duration:.4,ease:"power1.out",scale:1},0).to(t,{duration:.6,ease:"power1.out",scale:1,filter:"brightness(100%)"},0).to(e,{duration:.4,ease:"power2.in",opacity:0,scale:.2},.45)}hideAllImages(){this.isValid&&(this.images.forEach((e=>{gsap.set(e,{opacity:0,scale:.2})})),this.activeAnimations.forEach(((e,t)=>{e.kill()})),this.activeAnimations.clear(),this.hideAnimation&&(this.hideAnimation.kill(),this.hideAnimation=null),this.activeImagesCount=0,this.isIdle=!0,this.zIndex=1)}hideAllImagesSmoothly(){if(!this.isValid)return;this.activeAnimations.forEach(((e,t)=>{e.kill()})),this.activeAnimations.clear(),this.hideAnimation&&this.hideAnimation.kill();const e=this.images.filter((e=>gsap.getProperty(e,"opacity")>0));if(0===e.length)return this.activeImagesCount=0,void(this.isIdle=!0);this.hideAnimation=gsap.timeline({onComplete:()=>{this.activeImagesCount=0,this.isIdle=!0,this.zIndex=1,this.hideAnimation=null}}),e.forEach((e=>{const t=gsap.getProperty(e,"scale");gsap.getProperty(e,"opacity");this.hideAnimation.to(e,{duration:.3,ease:"power2.out",opacity:0,scale:.5*t,overwrite:!0},0)}))}onImageActivate(){this.activeImagesCount++}onImageComplete(){this.activeImagesCount--,0===this.activeImagesCount&&(this.isIdle=!0)}}class AgencyTrailManager{constructor(){this.agencyTrails=[],this.init()}init(){document.querySelectorAll(".agency").forEach((e=>{if(e.querySelector(".wrap-agency-animation")){const t=new AgencyTrail(e);t.isValid&&this.agencyTrails.push(t)}}))}}function autoResize(e){e&&(e.style.height="auto",e.style.height=e.scrollHeight+"px",updateScrollDelayed())}document.addEventListener("DOMContentLoaded",(()=>{window.innerWidth>1100&&new AgencyTrailManager})),window.innerWidth>1100&&(document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".item-rotate");if(!e.length)return;window.addEventListener("mousemove",(t=>{const i=window.innerWidth/2,n=15*((t.clientX-i)/i);e.forEach((e=>{gsap.to(e,{rotate:n,duration:.5,ease:"power3.out"})}))})),window.addEventListener("mouseleave",(()=>{e.forEach((e=>{gsap.to(e,{rotate:0,duration:1,ease:"power3.out"})}))}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("pupil");if(!e)return;const t=e.closest("svg");if(!e||!t)return;window.addEventListener("mousemove",(i=>{const n=t.getBoundingClientRect(),s=n.left+n.width/2,o=n.top+n.height/2,a=i.clientX-s,r=i.clientY-o,c=Math.atan2(r,a),l=Math.min(8,Math.hypot(a,r)),d=60+Math.cos(c)*l,h=60+Math.sin(c)*l;gsap.to(e,{attr:{cx:d,cy:h},duration:.2,ease:"power2.out"})})),window.addEventListener("mouseleave",(()=>{gsap.to(e,{attr:{cx:60,cy:60},duration:.3,ease:"power2.out"})}))})));const textarea=document.querySelector("textarea");function updateScrollDelayed(){gsap.delayedCall(.35,(()=>{void 0!==lenis&&("function"==typeof lenis.resize&&lenis.resize(),lenis.scrollTo(lenis.scroll,{immediate:!0})),window.dispatchEvent(new Event("resize"))}))}function handleAccordionClick(e){const t=e.siblings(".item"),i=e.hasClass("open");t.removeClass("open"),i?e.removeClass("open"):e.addClass("open"),updateScrollDelayed()}autoResize(textarea),textarea&&textarea.addEventListener("input",(()=>autoResize(textarea))),$(".services-frame .item").on("click",(function(){handleAccordionClick($(this))})),$(".faq-frame .item").on("click",(function(){handleAccordionClick($(this))}));let resizeTimeout,width=$(window).width();width<=750?$(".desk").remove():$(".mob").remove();let initialWidth=window.innerWidth;window.addEventListener("resize",(()=>{Math.abs(window.innerWidth-initialWidth)>10&&(clearTimeout(resizeTimeout),resizeTimeout=setTimeout((()=>{window.location.reload(),ScrollTrigger.refresh()}),300))}));let isReady=!1,isRedirectingFromCase=!1;function initAnchorLinks(){document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();const i=e.getAttribute("href");if(!i||"#"===i)return;const n=window.location.pathname,s="/"===n||"/index.html"===n||n.endsWith("/index.html");if(n.includes("case-page")||document.body.classList.contains("case-page")){const e=i.split("?")[0],t=`${window.location.origin}/index.html${e}?fromCase=true`;window.location.href=t}else if(s){const e=i.split("?")[0];console.log("Scrolling to anchor:",e),scrollToAnchor(e)}}))}))}function scrollToAnchor(e){if(!isReady)return void setTimeout((()=>scrollToAnchor(e)),100);const t=e.split("?")[0],i=document.querySelector(t);if(!i)return;const n=i.parentNode;let s=i;if(n.classList.contains("pin-spacer")){const e=n.previousElementSibling;if(e){const t=e.clientHeight||0;s=e.offsetTop+t}}lenis.scrollTo(s,{lerp:.1,duration:3,easing:e=>e<.5?2*e*e:(4-2*e)*e-1})}window.addEventListener("load",(()=>{const e=new URLSearchParams(window.location.search);isRedirectingFromCase="true"===e.get("fromCase")||document.referrer.includes("case-page");const t=()=>{if("undefined"==typeof gsap||"undefined"==typeof ScrollTrigger||void 0===lenis)return console.warn("⏳ Ждем GSAP / ScrollTrigger / Lenis..."),requestAnimationFrame(t);gsap.delayedCall(.3,(()=>{isRedirectingFromCase||lenis.scrollTo(0,{immediate:!0,duration:.1}),requestAnimationFrame((()=>{requestAnimationFrame((()=>{initAnchorLinks(),isReady=!0,isRedirectingFromCase&&window.location.hash&&setTimeout((()=>{scrollToAnchor(window.location.hash)}),100)}))}))}))};setTimeout(t,300)})),width>750&&function(){const e={x:window.innerWidth/2,y:window.innerHeight/2,prevX:window.innerWidth/2,prevY:window.innerHeight/2,speed:0,isHovering:!1},t=document.getElementById("cursorTrail"),i=document.getElementById("cursorDot"),n=[];for(let i=0;i<10;i++){const i=document.createElement("div");i.className="cursor-dot tail",t.appendChild(i),n.push({el:i,x:e.x,y:e.y,scale:1,opacity:0})}function s(t){const i=t.clientX||t.touches&&t.touches[0].clientX||e.x,n=t.clientY||t.touches&&t.touches[0].clientY||e.y;e.speed=Math.hypot(i-e.prevX,n-e.prevY),e.prevX=e.x,e.prevY=e.y,e.x=i,e.y=n,function(t,i){const n=document.elementFromPoint(t,i);if(n){const t="A"===n.tagName||"BUTTON"===n.tagName||"pointer"===n.style.cursor||"pointer"===window.getComputedStyle(n).cursor;e.isHovering=t}else e.isHovering=!1}(i,n)}function o(e,t,i){return e+(t-e)*i}window.addEventListener("pointermove",s,{passive:!0}),window.addEventListener("touchmove",s,{passive:!0}),function t(){e.speed*=.85,requestAnimationFrame(t)}(),requestAnimationFrame((function t(){const s=o(parseFloat(i.dataset.scale||1),e.isHovering?1.2:1,.2);i.dataset.scale=s,i.style.transform=`translate3d(${e.x}px, ${e.y}px,0) translate(-50%, -50%) scale(${s})`;const a=e.speed>1.5;for(let t=0;t<n.length;t++){const i=0===t?{x:e.x,y:e.y}:n[t-1],s=n[t];s.x=o(s.x,i.x,.15+.015*t),s.y=o(s.y,i.y,.15+.015*t);let r=1;if(a){r+=Math.min(e.speed/25,1)*(1-t/n.length)*1.6}s.scale=o(s.scale,r,.08),s.el.style.transform=`translate3d(${s.x}px, ${s.y}px,0) translate(-50%, -50%) scale(${s.scale})`;const c=e.speed<.1?0:.2*(1-t/n.length);s.opacity=o(s.opacity,c,.1),s.el.style.opacity=s.opacity.toFixed(2)}requestAnimationFrame(t)}))}();class DotGrid{constructor(e){this.canvas=e,this.ctx=e.getContext("2d"),this.mouse={x:0,y:0,active:!1},this.spacing=36,this.baseR=1.2,this.maxR=2.8,this.resize(),this.createDots(),this.bindEvents(),this.animate()}bindEvents(){window.addEventListener("mousemove",(e=>{this.mouse.x=e.clientX,this.mouse.y=e.clientY,this.mouse.active=!0})),window.addEventListener("mouseleave",(()=>this.mouse.active=!1))}resize(){clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout((()=>{const e=window.devicePixelRatio||1;this.canvas.width=this.canvas.offsetWidth*e,this.canvas.height=this.canvas.offsetHeight*e,this.ctx.scale(e,e),this.createDots()}),300)}createDots(){this.dots=[];const e=this.canvas.offsetWidth,t=this.canvas.offsetHeight,i=this.spacing/2;for(let n=i;n<e-i;n+=this.spacing)for(let e=i;e<t-i;e+=this.spacing)this.dots.push({x:n,y:e,r:this.baseR,opacity:0})}animate(){this.ctx.clearRect(0,0,this.canvas.offsetWidth,this.canvas.offsetHeight);const e=this.canvas.getBoundingClientRect();for(const t of this.dots){const i=this.mouse.x-(e.left+t.x),n=this.mouse.y-(e.top+t.y),s=Math.hypot(i,n),o=0;s<110&&this.mouse.active?(t.r=this.baseR+(this.maxR-this.baseR)*(1-s/110),t.opacity+=.15*(.2-t.opacity)):(t.r+=.1*(this.baseR-t.r),t.opacity+=.08*(o-t.opacity)),this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI),this.ctx.fillStyle=`rgba(143,145,154,${t.opacity})`,this.ctx.fill()}requestAnimationFrame((()=>this.animate()))}}document.addEventListener("DOMContentLoaded",(()=>{window.innerWidth>1100&&document.querySelectorAll(".dot-canvas").forEach((e=>new DotGrid(e)))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".file-wrap");if(!e)return;const t=e.querySelector('input[type="file"]'),i=e.querySelector(".clear-file"),n=e.querySelector(".file-name");t.addEventListener("change",(function(){this.files&&this.files.length>0?(e.classList.add("has-file"),n.textContent=this.files[0].name):(e.classList.remove("has-file"),n.textContent="Прикрепить файл")})),i.addEventListener("click",(function(i){i.preventDefault(),i.stopPropagation(),t.value="",e.classList.remove("has-file"),n.textContent="Прикрепить файл"}))})),$(".wrap-answer .item").on("click",(function(e){let t=$(this).text();$("#custom-select").val(t)}));let col=0;$(".form-action button").on("click",(function(e){document.querySelectorAll(".input-wrap input, .input-wrap textarea").forEach(((e,t)=>{""===e.value?(e.classList.add("error"),e.classList.remove("has-val")):(col++,e.classList.remove("error"),e.classList.add("has-val"))})),5==col&&($(".feedback-form-main").remove(),$(".form-send").fadeIn(300),$(".form-default").remove(),lenis.scrollTo(".ancor-form",{duration:.3}))}));let windowWidth=window.innerWidth,windowHeight=window.innerHeight,IsDestop=width>1100,isTouch=window.innerWidth<1100&&window.innerWidth>750;if(document.querySelector(".hero-block")&&IsDestop){let e={scale:IsDestop?15:30,yPercent:150,xPercent:IsDestop?-70:-0,end:IsDestop?"+=75%":"+=100%"};gsap.to(".hero-block .circle-hero",{scale:e.scale,yPercent:e.yPercent,xPercent:e.xPercent,scrollTrigger:{trigger:".hero-block",start:"top top",end:e.end,scrub:1,pin:!0,pinSpacing:!1,onUpdate:e=>{let t=10*e.progress;IsDestop&&(document.querySelector(".cursor-trail").style.zIndex=t>1.5&&t<10?"5":"1");let i=e.progress,n=1-10*i,s=1-10*i;$(".hero-block .stoke-title").css({opacity:n}),$(".hero-block-scroll").css({opacity:s})}}})}let lastIndex=0;if(document.querySelector(".xcode")){let t,i,n,s,o=document.querySelector(".xcode-cards"),a=gsap.utils.toArray(".xcode-cards .item"),r=a.length-1;function updateXcodeMetrics(){t=a[0].offsetWidth,i=parseFloat(getComputedStyle(o).gap)||0,n=(t+i)*(a.length-1),s=(t+i)*(a.length-1)-(t-(8*i-10))}updateXcodeMetrics();let c={start:isTouch&&windowWidth<windowHeight?"top top":isTouch&&windowWidth>windowHeight?"top top-=25%":IsDestop?"top+=35%":"top+=30%",end:IsDestop||isTouch?n:s};const l=gsap.timeline({scrollTrigger:{trigger:".xcode",start:c.start,end:()=>`${c.end}px`,pin:!0,scrub:1,onUpdate:e=>{const t=e.progress,i=getIndexFromX();t<=.001?0!==lastIndex&&(lastIndex=0,setActive(0)):t>=.999?lastIndex!==r&&(lastIndex=r,setActive(r)):i!==lastIndex&&(lastIndex=i,setActive(i))}}});function getIndexFromX(){const e=gsap.getProperty(".xcode-cards","x"),n=t+i,s=Math.abs(e)/n;return Math.min(r,Math.round(s))}function setActive(e){e=Math.max(0,Math.min(e,a.length-1)),o.dataset.activeIndex!=e&&(a.forEach((e=>e.classList.remove("active"))),a[e].classList.add("active"),o.dataset.activeIndex=e)}l.to(".xcode-cards",{x:-(IsDestop||isTouch?n:s),ease:"none"})}if(document.querySelector(".wrap-agency-animation")&&!IsDestop){document.querySelectorAll(".wrap-agency-animation .content").forEach(((e,t)=>{let i,n,s,o,a=e.querySelectorAll(".content__img");i=a[0].offsetWidth,n=parseFloat(getComputedStyle(e).gap)||0,o=(i+n)*(a.length-1)-i-i-5*n,s=(i+n)*(a.length-1)-(i-2*n);const r={start:isTouch?"top center+=10%":"top bottom",end:"+=100%"};gsap.timeline({scrollTrigger:{trigger:e,start:r.start,end:()=>r.end,scrub:1}}).to(e,{x:isTouch?-o:-s,ease:"power1.inOut",overwrite:"auto"})}))}if(document.querySelector(".feedback")&&width>750&&gsap.set(".feedback-form, .guarantees-section",{yPercent:-92,scale:.3,xPercent:-35}),document.querySelector(".guarantees")){let d,h=window.innerWidth<380;d=isTouch?windowHeight<800?"+=35%":"+=11%":h?"+=20%":IsDestop?"+=45%":windowWidth>500?"+=25%":"+=13%",gsap.to(".guarantees-section",{yPercent:0,xPercent:0,scale:1,ease:"power1.inOut",scrollTrigger:{trigger:".guarantees__wrap",start:isTouch?"top center+=20%":"top center",end:"+=70%",scrub:!0}});let u={scale:IsDestop?16:25,yPercent:IsDestop?-60:-80,start:d,end:IsDestop?"+=200%":h?"+=300%":"+=200%"};gsap.to(".guarantees-circle",{yPercent:u.yPercent,scale:isTouch?30:u.scale,ease:"power1.inOut",rotate:90,scrollTrigger:{trigger:".guarantees",start:u.start,end:isTouch&&windowHeight<800?"+=330%":isTouch?"+=170%":u.end,scrub:1,pin:!0,pinSpacing:!1,onUpdate:e=>{let t=e.progress;document.querySelector(".guarantees-canvas")&&t>=.4?document.querySelector(".guarantees-canvas").style.opacity="1":t<.4&&document.querySelector(".guarantees-canvas")&&(document.querySelector(".guarantees-canvas").style.opacity="0")}}})}if(document.querySelector(".implementation")&&IsDestop){let m=document.querySelector(".implementation").clientHeight,p={scale:IsDestop?15:30,yPercent:450,xPercent:IsDestop?-70:-0,end:IsDestop?"+=75%":"+=100%",start:windowWidth>=1920?"top top+=20%":`top top+=${5+(windowHeight-m)/10}%`};gsap.to(".implementation .circle-hero",{scale:p.scale,yPercent:p.yPercent,xPercent:p.xPercent,scrollTrigger:{trigger:".implementation",start:p.start,end:p.end,scrub:1,onUpdate:e=>{let t=e.progress;IsDestop&&(document.querySelector("#imp-canvas").style.opacity=t>=.2?"1":"0");let i=1-5*t;$(".implementation .stoke-title").css({opacity:i})}}})}function splitLetters(){document.querySelectorAll(".split-light, .split-dark").forEach((e=>{if(e.querySelector(".char"))return;const t=e.textContent.trim(),i=document.createDocumentFragment();for(const e of t)if(/\s/.test(e))i.append(e);else{const t=document.createElement("span");t.className="char",t.textContent=e,i.append(t)}e.textContent="",e.appendChild(i)}))}function initScrollAnimations(){const e="#BEBFC3",t="#8F919A";document.querySelectorAll(".split-light, .split-dark").forEach((i=>{const n=i.querySelectorAll(".char");if(!n.length)return;const s=i.classList.contains("split-light")?e:t;gsap.set(n,{color:s,willChange:"color"}),gsap.to(n,{color:"#fff",ease:"power2.out",stagger:{each:.02,from:"start"},scrollTrigger:{trigger:i,start:"top 80%",end:"bottom 20%",scrub:!0}})}))}function initSplitAnimation(){splitLetters(),requestAnimationFrame((()=>{initScrollAnimations()}))}if(document.querySelector(".feedback-form")&&width>750&&gsap.to(".feedback-form",{yPercent:0,xPercent:0,scale:1,ease:"power1.inOut",scrollTrigger:{trigger:".feedback-wrap",start:isTouch?"top center+=20%":"top center",end:"+=70%",scrub:1}}),window.innerWidth>750&&initSplitAnimation(),width>750){const g=document.querySelectorAll(".line path"),y=new Map;function updateLinePath(e,t,i){const n=100,s=500,o=Math.max(0,Math.min(2e3,i)),a=[{x:0,y:n},{x:o-250,y:n},{x:o,y:n+t},{x:o+250,y:n},{x:2e3,y:n}];let r=`M${a[0].x} ${a[0].y}`;r+=` L${a[1].x} ${a[1].y}`,r+=` C${a[1].x+125} ${a[1].y}, \n           ${a[2].x-s/6} ${a[2].y}, \n           ${a[2].x} ${a[2].y}`,r+=` C${a[2].x+s/6} ${a[2].y}, \n           ${a[3].x-125} ${a[3].y}, \n           ${a[3].x} ${a[3].y}`,r+=` L${a[4].x} ${a[4].y}`,e.setAttribute("d",r)}g.forEach((e=>{y.set(e,{depth:0,x:1e3,tween:null})})),document.addEventListener("mousemove",(e=>{g.forEach((t=>{const i=y.get(t),n=t.closest("svg").getBoundingClientRect(),s=n.top+n.height/2,o=Math.abs(e.clientY-s),a=o<80,r=1-Math.pow(o/80,1.5),c=a?Math.max(-80,Math.min(80,(s-e.clientY)*r*2.5)):0,l=2e3/n.width,d=(e.clientX-n.left)*l;i.tween&&i.tween.kill(),i.tween=gsap.to(i,{duration:.4,depth:c,x:d,ease:"power2.out",onUpdate:()=>{updateLinePath(t,i.depth,i.x)}})}))})),document.addEventListener("mouseleave",(()=>{g.forEach((e=>{const t=y.get(e);t.tween&&t.tween.kill(),t.tween=gsap.to(t,{duration:.8,depth:0,x:1e3,ease:"elastic.out(1, 0.4)",onUpdate:()=>{updateLinePath(e,t.depth,t.x)}})}))}))}function setupMarquee(e,{duration:t=15,enterX:i=0,scrollStart:n="top bottom",scrollEnd:s="+=150%"}={}){if(!e||!e.firstElementChild)return;const o=e.firstElementChild,a=parseFloat(getComputedStyle(e).gap)||0;let r,c=0;function l(){const e=o.scrollWidth;c=e+a}l(),setTimeout(l,50),setTimeout(l,150),gsap.killTweensOf(e),ScrollTrigger.getAll().forEach((t=>{t.trigger===e&&t.kill()})),e.style.willChange="transform",gsap.set(e,{x:0,force3D:!0}),setTimeout((function(){const t=c/120;r=gsap.to(e,{x:-c,duration:t,repeat:-1,ease:"none",paused:!0}),ScrollTrigger.isInViewport(e)&&r.resume()}),160),ScrollTrigger.create({trigger:e,start:n,end:s,scrub:1,ease:"power1.InOut",markers:!1,onUpdate:t=>{gsap.to(e,{xPercent:gsap.utils.mapRange(0,1,i,0,t.progress),duration:.25,ease:"power1.out",overwrite:"auto"})}}),ScrollTrigger.create({trigger:e,start:"top bottom",end:"bottom top",onEnter:()=>r&&r.resume(),onEnterBack:()=>r&&r.resume(),onLeave:()=>r&&r.pause(),onLeaveBack:()=>r&&r.pause()})}function initMarquees(){const e=window.matchMedia("(max-width: 750px)").matches;document.querySelectorAll([".stoke-title .stroke-wrap",".agency-stroke:not(.special-margue-container .agency-stroke)",".longest__body .stroke-wrap",".case-frame .item .item-stroke-wrap",".footer-stroke",".about-stroke"].join(", ")).forEach((e=>{setupMarquee(e,{enterX:0})})),document.querySelectorAll(".special-margue-container").forEach((t=>{gsap.set(t,{xPercent:-100});const i=t.querySelector(".agency-stroke");gsap.set(i,{xPercent:100}),i&&setupMarquee(i,{duration:e?12:10,enterX:100})})),ScrollTrigger.refresh(!0)}function startWhenFontsReady(){document.fonts?document.fonts.ready.then((()=>{setTimeout((()=>{initMarquees()}),50)})):initMarquees()}function isElementInViewport(e){const t=e.getBoundingClientRect();return t.top<=.6*window.innerHeight&&t.bottom>=.4*window.innerHeight}function updateActiveNav(){const e=document.querySelectorAll("section[id]"),t=document.querySelectorAll(".navbar .ancor-item"),i=document.querySelector(".home-btn");if(window.scrollY<50)return t.forEach((e=>e.parentElement.classList.remove("current"))),void(i&&i.parentElement.classList.add("current"));let n=!1;for(let s=e.length-1;s>=0;s--){const o=e[s];if(isElementInViewport(o)){const e=o.getAttribute("id"),s=document.querySelector(`.navbar .ancor-item[href="#${e}"]`);t.forEach((e=>e.parentElement.classList.remove("current"))),s&&(s.parentElement.classList.add("current"),i.parentElement.classList.remove("current"),n=!0);break}}}window.addEventListener("load",startWhenFontsReady),document.addEventListener("DOMContentLoaded",(function(){updateActiveNav()})),void 0!==lenis&&width>750&&lenis.on("scroll",updateActiveNav);const preloader=document.querySelector(".preloader"),progressLine=document.querySelector(".line span"),procentElement=document.querySelector(".procent");let progress=0;const targetProgress=100,duration=IsDestop?3e3:5e3,interval=30,increment=100/duration*30,progressInterval=setInterval((()=>{progress+=increment;const e=Math.min(progress,100);progressLine.style.width=e+"%",procentElement.textContent=Math.round(e)+"%","complete"===document.readyState&&(progress=Math.max(progress,0)),e>=100&&(clearInterval(progressInterval),"complete"===document.readyState?hidePreloader():window.addEventListener("load",hidePreloader))}),30);function hidePreloader(){preloader.style.opacity="0",preloader.style.transition="opacity 0.5s ease",setTimeout((()=>{preloader.style.display="none"}),500)}setTimeout(hidePreloader,5e3);